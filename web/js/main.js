/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

var requirejs,require,define;!function(e){function n(e,n){return v.call(e,n)}function t(e,n){var t,i,r,o,u,a,l,c,f,s,d,h=n&&n.split("/"),p=g.map,m=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(n){for(e=e.split("/"),u=e.length-1,g.nodeIdCompat&&y.test(e[u])&&(e[u]=e[u].replace(y,"")),e=h.slice(0,h.length-1).concat(e),f=0;f<e.length;f+=1)if(d=e[f],"."===d)e.splice(f,1),f-=1;else if(".."===d){if(1===f&&(".."===e[2]||".."===e[0]))break;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||m)&&p){for(t=e.split("/"),f=t.length;f>0;f-=1){if(i=t.slice(0,f).join("/"),h)for(s=h.length;s>0;s-=1)if(r=p[h.slice(0,s).join("/")],r&&(r=r[i])){o=r,a=f;break}if(o)break;!l&&m&&m[i]&&(l=m[i],c=f)}!o&&l&&(o=l,a=c),o&&(t.splice(0,a,o),e=t.join("/"))}return e}function i(n,t){return function(){var i=w.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),f.apply(e,i.concat([n,t]))}}function r(e){return function(n){return t(n,e)}}function o(e){return function(n){h[e]=n}}function u(t){if(n(p,t)){var i=p[t];delete p[t],m[t]=!0,c.apply(e,i)}if(!n(h,t)&&!n(m,t))throw new Error("No "+t);return h[t]}function a(e){var n,t=e?e.indexOf("!"):-1;return t>-1&&(n=e.substring(0,t),e=e.substring(t+1,e.length)),[n,e]}function l(e){return function(){return g&&g.config&&g.config[e]||{}}}var c,f,s,d,h={},p={},g={},m={},v=Object.prototype.hasOwnProperty,w=[].slice,y=/\.js$/;s=function(e,n){var i,o=a(e),l=o[0];return e=o[1],l&&(l=t(l,n),i=u(l)),l?e=i&&i.normalize?i.normalize(e,r(n)):t(e,n):(e=t(e,n),o=a(e),l=o[0],e=o[1],l&&(i=u(l))),{f:l?l+"!"+e:e,n:e,pr:l,p:i}},d={require:function(e){return i(e)},exports:function(e){var n=h[e];return"undefined"!=typeof n?n:h[e]={}},module:function(e){return{id:e,uri:"",exports:h[e],config:l(e)}}},c=function(t,r,a,l){var c,f,g,v,w,y,x=[],b=typeof a;if(l=l||t,"undefined"===b||"function"===b){for(r=!r.length&&a.length?["require","exports","module"]:r,w=0;w<r.length;w+=1)if(v=s(r[w],l),f=v.f,"require"===f)x[w]=d.require(t);else if("exports"===f)x[w]=d.exports(t),y=!0;else if("module"===f)c=x[w]=d.module(t);else if(n(h,f)||n(p,f)||n(m,f))x[w]=u(f);else{if(!v.p)throw new Error(t+" missing "+f);v.p.load(v.n,i(l,!0),o(f),{}),x[w]=h[f]}g=a?a.apply(h[t],x):void 0,t&&(c&&c.exports!==e&&c.exports!==h[t]?h[t]=c.exports:g===e&&y||(h[t]=g))}else t&&(h[t]=a)},requirejs=require=f=function(n,t,i,r,o){if("string"==typeof n)return d[n]?d[n](t):u(s(n,t).f);if(!n.splice){if(g=n,g.deps&&f(g.deps,g.callback),!t)return;t.splice?(n=t,t=i,i=null):n=e}return t=t||function(){},"function"==typeof i&&(i=r,r=o),r?c(e,n,t,i):setTimeout(function(){c(e,n,t,i)},4),f},f.config=function(e){return f(e)},requirejs._defined=h,define=function(e,t,i){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(i=t,t=[]),n(h,e)||n(p,e)||(p[e]=[e,t,i])},define.amd={jQuery:!0}}(),define("almond",function(){}),define("zhl",[],function(){return window.zhl={},window.zhl.viewModels={},window.zhl}),define("tool",[],function(){function e(e){if(null==e)throw"specific can not be null";return e}function n(){return void 0===value||null===value||0===value||""===value}function t(e,n){if(!e)throw"a container is required!";var t=document.createDocumentFragment();return i(n)?n.foreach(function(e){t.appendChild(e)}):t.appendChild(n),e.appendChild(t),t=null,e}function i(e){return"object"==typeof e&&e instanceof Array}function r(e,n){if(!e)throw"A canvas is required";var t,i=e,r=i.getContext("2d");if(devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStroePixelRatio||r.backingStroePixelRatio||1,ratio=devicePixelRatio/backingStoreRatio,"undefined"==typeof n&&(t=!0),t){var o=window.innerWidth,u=window.innerHeight;i.width=o*ratio,i.height=u*ratio,i.style.width=o+"px",i.style.height=u+"px",r.scale(ratio,ratio)}return i}var o={scaleCanvas:r,appendToPage:t,isArray:i,isNull:e,isEmpty:n};return o}),define("rain",["tool"],function(e){function n(n){function t(e){var n=document.getElementById(e);if(!n)throw"Canvas is not found!";return n}function i(){return Math.round(g.width/s)}function r(e){return{size:~~(20*(Math.random()-.5)+10),srcy:~~(g.height*Math.random()*.8),desy:0,xPos:e*s,db:4}}function o(e){for(var n=[],t=0;e>t;t++)n[t]=r(t);return n}function u(){m.fillStyle="rgba(0,0,0,.05)",m.fillRect(0,0,window.innerWidth,window.innerHeight-d),m.fillStyle="rgba(255,255,255,.08)",m.fillRect(0,window.innerHeight-d,window.innerWidth,d),m.fillStyle=h,w.map(function(e,n){var t=e.srcy-(window.innerHeight-e.desy);0>=t&&(e.db<2?(m.font="bold "+e.size+"px serif",m.fillText(e.text,e.xPos,e.srcy),e.db++):(e.text=String.fromCharCode(12448+Math.round(95*Math.random())),m.font="bold "+e.size+"px serif",m.fillText(e.text,e.xPos,e.srcy),e.db=0)),t>1e4*~~Math.random()&&(w[n]=r(n)),e.db<2?e.srcy++:e.srcy+=e.size})}function a(){return y=setInterval(u,30)}function l(e){clearInterval(e),start=null,g.style.display="none"}function c(){g.setAttribute("class",p)}function f(){l(y)}const s=20,d=60,h="rgba(35,255,35,.8)",p="preface-hidden";var g,m,v,w,y;this.startRain=a,this.removeCanvas=f,this.extendAway=c,g=t(n||""),g=e.scaleCanvas(g),m=g.getContext("2d"),m.fillStyle=h,v=i(),w=o(v)}return n}),define("logo",["tool"],function(e){function n(n){function t(e){var n=r("div");return n.setAttribute("class",c),n.innerHTML=e,n}function i(e){var n=e.split("");return n.map(function(e,n){return"<span class='char char"+n+"'>"+e+"</span>"}).join("")}function r(e){return document.createElement(e)}function o(e){e.getAttribute("class");e.setAttribute("class","container move")}function u(e){e.setAttribute("class","container stop")}function a(){f.setAttribute("class","container move extendAway")}function l(){d.style.display="none"}const c="container";var f,s,d;return d=document.getElementById(n),s=i("THE MATRIX"),f=t(s),e.appendToPage(d,f),{moveLight:function(){o(f)},stopLight:function(){u(f)},extendAway:a,remove:l}}return n}),define("porfacePortrait",["tool"],function(e){function n(){function n(){r.el.style.opacity=0}function t(){r.el.style.display="none"}function i(t){var i=document.getElementById("escape-btn");i=e.isNull(i),i.addEventListener("click",function r(){i.removeEventListener("click",r,!1),i.style.display="none",n(),t()},!1)}var r={el:e.isNull(document.getElementById("preface-portrait")),removePortrait:t,addListener:i};return r}return n}),define("charPhoto",["tool"],function(e){function n(n){function t(){var e,n,t,c,d,h=null;d=r(),e=~~(S.width*d),n=~~(S.height*d),S.width=e,S.height=n,P=A=(window.innerWidth-e)/2,t=u(q,S,d),c=a(t.data,e,n),t=null,q.scale(1,1),q.fillStyle="black",q.fillRect(0,0,g,m),R=l(!0),f("bold 12px serif",y),h||(h=setInterval(function(){var e=i(c);e?s(e):(q=o(q,x,"center",window.innerWidth/2,C+12),clearInterval(h),setTimeout(function(){q=o(q,b,"center",window.innerWidth/2,C+26)},100),h=null)},v))}function i(e){var n=e.shift();return n?"_"==n?(P+=E,i(e)):n:!1}function r(){var e,n=m-2*k-10-14;return n=Math.min(w,n),e=+(n/w).toFixed(2)}function o(e,n,t,i,r){return e.textAlign=t||"center",e.fillText(n,i,r),e}function u(e,n,t){return e.drawImage(n,0,0,n.width,n.height),e.getImageData(0,0,n.width,n.height)}function a(e,n,t){for(var i=[],r=0;t>r;r+=12){for(var o=0;n>o;o+=6){var u=4*(o+r*n),a=e[u+0],l=e[u+1],c=e[u+2],f=d(a,l,c);i.push(h(f))}i.push("=")}return i}function l(e){return R.style.display=e?"block":"none",R}function c(){return R.width=g,R.height=m,R.setAttribute("class",""),R.style.width=g+"px",R.style.height=m+"px",R}function f(e,n){return q.fillStyle=n,q.font=e,q}function s(e){return"="==e?(C+=I,P=A,!0):(P+=E,q.fillStyle="rgba(35,255,35,"+e+")",q.fillRect(P+E,C-I,4,10),!0)}function d(e,n,t){return.299*e+.578*n+.114*t}function h(e){return e+=20,240>=e?(e/255).toFixed(2):"_"}const p=60,g=window.innerWidth,m=window.innerHeight-p,v=30,w=814,y="rgba(35,255,35,0.8)",x="============================== YOU ARE IN ==============================",b="============================== WWW.DOMTRIC.COM ==============================";var P,A,R,q,k=20,C=k,E=6,I=12,S=new Image,T="web/images/preface-portrait-s.png";S.src=T,R=e.isNull(document.getElementById(n)),q=R.getContext("2d"),R=c(),R=l(!0),S.onload=t}return n}),require(["zhl","rain","tool","logo","porfacePortrait","charPhoto"],function(){function e(){setTimeout(function(){t.rain.startRain();setTimeout(function(){t.portrait.removePortrait(),n(t.portrait),t.logo.moveLight(),setTimeout(function(){t.rain.extendAway(),t.logo.extendAway(),setTimeout(function(){t.rain.removeCanvas(),t.logo.remove(),n(t.rain),n(t.logo),setTimeout(function(){u("preface")},100)},3500)},2800)},5e3)},500)}function n(e){e=null,delete e}var t=require("zhl"),i=require("rain"),r=require("logo"),o=(require("tool"),require("porfacePortrait")),u=require("charPhoto");t.rain=new i("preface"),t.logo=r("logo"),t.portrait=o(),t.portrait.addListener(e)}),define("main",function(){});